lm(b ~ a, data_ab)
View(data_ab)
data_ab = data.frame(a,b)
View(data_ab)
# run a model estimating their relationship
lm(b ~ a, data_ab)
# run a model estimating their relationship
lm(b ~ a)
# packages
library(tidyverse)
library(stargazer)
library(coefplot)
# create a variable - x
x =
# create a variable - z
z = rnorm(1000)
# create a variable - x
x = z * 10 + rnorm(1000)
# create a variable - y
y = z * -5 + rnomr(1000)
# plot - x & y
plot(x,y)
# regress y on x
lm(y ~ x)
# create a variable - y
y = z * 2 + rnorm(1000)
# plot - x & y
plot(x,y)
# regress y on x
lm(y ~ x)
# create a variable - y
y = z * 2 + rnorm(1000)
# plot - x & y
plot(x,y)
# create a variable - y
y = z * -2 + rnorm(1000)
# plot - x & y
plot(x,y)
# create a variable - y
y = z * -5 + rnorm(1000)
# plot - x & y
plot(x,y)
# regress y on x
lm(y ~ x)
# regress y on x
summary(lm(y ~ x))
# run a model estimating their relationship
summary(lm(b ~ a))
wage = read_csv("height_wage.csv")
## data
data = read_csv("height_wage.csv")
## boxplots - logged
ggplot(data, aes(log(wage96)))+
geom_boxplot()+
facet_wrap(~male)+
coord_flip()
## boxplots
ggplot(data, aes(wage96))+
geom_boxplot()+
facet_wrap(~male)+
coord_flip()
## quick look at the data again
ggplot(data, aes(height85, wage96))+
geom_point()
## separated by gender
ggplot(data, aes(height85, log(wage96), color = factor(male)))+
geom_point(position = "jitter", alpha = .5)+
geom_smooth(method = "lm",se = F)
## creating a dummy for our max value
data2 = data %>%
mutate(max_wage = if_else(wage96 == max(wage96), 1, 0))
# subset our data for the below example to work
sample = data2[4500:4599,]
## thinking about leverage
lev_mod = lm(log(wage96) ~ height85, data = sample)
ggplot(sample, aes(height85, log(wage96), color = factor(max_wage)))+
geom_point(aes(size = factor(max_wage)))+
geom_vline(aes(xintercept = mean(height85)), color = "blue", linetype = "dashed")+
scale_size_manual(values = c(1,5),guide = "none")+
scale_color_manual(values = c("black", "red"), guide = "none")+
geom_smooth(method = "lm", se = F, color = "green")+
annotate(geom = "text", label = paste0("Beta =",round(lev_mod$coefficients[2], digits = 2)) , x = 72.5, y = 5)
## change outlier height
sample$height85[sample$max_wage == 1] <- mean(sample$height85)
# run model again
lev_mod = lm(log(wage96) ~ height85, data = sample)
## look at our graph now
ggplot(sample, aes(height85, log(wage96), color = factor(max_wage)))+
geom_point(aes(size = factor(max_wage)))+
geom_vline(aes(xintercept = mean(height85)), color = "blue", linetype = "dashed")+
scale_size_manual(values = c(1,5),guide = "none")+
scale_color_manual(values = c("black", "red"), guide = "none")+
geom_smooth(method = "lm", se = F, color = "green")+
annotate(geom = "text", label = paste0("Beta =",round(lev_mod$coefficients[2], digits = 2)) , x = 72.5, y = 5)
## change outlier height
sample$height85[sample$max_wage == 1] <- 48
# run model again
lev_mod = lm(log(wage96) ~ height85, data = sample)
## look at our graph now
ggplot(sample, aes(height85, log(wage96), color = factor(max_wage)))+
geom_point(aes(size = factor(max_wage)))+
geom_vline(aes(xintercept = mean(height85)), color = "blue", linetype = "dashed")+
scale_size_manual(values = c(1,5),guide = "none")+
scale_color_manual(values = c("black", "red"), guide = "none")+
geom_smooth(method = "lm", se = F, color = "green")+
annotate(geom = "text", label = paste0("Beta =",round(lev_mod$coefficients[2], digits = 2)) , x = 72.5, y = 5)
## change outlier height
sample$height85[sample$max_wage == 1] <- 84
# run model again
lev_mod = lm(log(wage96) ~ height85, data = sample)
## look at our graph now
ggplot(sample, aes(height85, log(wage96), color = factor(max_wage)))+
geom_point(aes(size = factor(max_wage)))+
geom_vline(aes(xintercept = mean(height85)), color = "blue", linetype = "dashed")+
scale_size_manual(values = c(1,5),guide = "none")+
scale_color_manual(values = c("black", "red"), guide = "none")+
geom_smooth(method = "lm", se = F, color = "green")+
annotate(geom = "text", label = paste0("Beta =",round(lev_mod$coefficients[2], digits = 2)) , x = 72.5, y = 5)
## default plot options
plot(model1)
model1 = lm(wage96 ~ height85, data = data)
## what about the log relationship with the dependent variable?
model2 = lm(log(wage96) ~ height85, data = data)
## default plot options
plot(model1)
## logged model
plot(model2)
## adding dffits - predicted point from model when that point is left out
data_res$m1_dffits <- dffits(model1)
## adding dffits - predicted point from model when that point is left out
data_res$m1_dffits <- dffits(model1)
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Stadium == "Tokyo Underpass")
data %>%
filter(Stadium == "Tokyo Underpass") %>%
arrange(desc(Score))
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(wp)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(W)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(L)
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
#geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
#geom_smooth(se = F)+
#geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(method = "lm", se = F)+
#geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(goals = sum(Goals), shots = sum(Shots), pct = (goals/shots) * 100)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(goals = sum(Goals, na.rm = T), shots = sum(Shots, na.rm = T), pct = (goals/shots) * 100)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(L)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(avg = round(mean(Score, na.rm = T), digits = 0), goals = sum(Goals, na.rm = T), assists = sum(Assists, na.rm = T), saves = sum(Saves, na.rm = T))
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(avg = round(mean(Score, na.rm = T), digits = 0), goals = sum(Goals, na.rm = T), assists = sum(Assists, na.rm = T), saves = sum(Saves, na.rm = T))
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(method = "lm", se = F)+
#geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(goals = sum(Goals, na.rm = T), shots = sum(Shots, na.rm = T), pct = (goals/shots) * 100)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(avg = round(mean(Score, na.rm = T), digits = 0), goals = sum(Goals, na.rm = T), assists = sum(Assists, na.rm = T), saves = sum(Saves, na.rm = T))
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(L)
arrange(wp_
data %>%
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(wp)
wage = read_csv("height_wage.csv")
View(wage)
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(wp)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Season) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(wp)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarize(games = n(), gpg = sum(Goals, na.rm = T)/games , apg = sum(Assists)/games, spg = sum(Saves)/games) %>%
arrange(desc(spg))
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(goals = sum(Goals, na.rm = T), shots = sum(Shots, na.rm = T), pct = (goals/shots) * 100)
data %>%
filter(Post == "1") %>%
arrange(desc(Score))
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(method = "lm", se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
ggplot(aes(x = game, y = Score))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Opponent) %>%
summarize(games = n(), gpg = sum(Goals, na.rm = T)/games , apg = sum(Assists)/games, spg = sum(Saves)/games) %>%
arrange(desc(spg))
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Season) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(wp)
data %>%
filter(Post == 0) %>%
filter(Player == "Octane") %>%
group_by(Season) %>%
summarise(games = n(), W = sum(W), L = games - W, wp = W/games) %>%
arrange(W)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(avg = round(mean(Score, na.rm = T), digits = 0), goals = sum(Goals, na.rm = T), assists = sum(Assists, na.rm = T), saves = sum(Saves, na.rm = T))
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season, Player) %>%
summarize(goals = sum(Goals, na.rm = T), shots = sum(Shots, na.rm = T), pct = (goals/shots) * 100)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season) %>%
summarize(GS = sum(GS), GA = sum(GA), DF = GS - GA)
filter(Player == "Merc) %>%
data %>%
filter(Player == "Merc") %>%
data %>%
filter(Player == "Merc") %>%
filter(Post == 0) %>%
group_by(Season) %>%
summarize(GS = sum(GS), GA = sum(GA), DF = GS - GA)
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
group_by(Season) %>%
summarize(GS = sum(GS), GA = sum(GA), DF = GS - GA)
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data = read_sheet("https://docs.google.com/spreadsheets/d/1CbB48Kr7bcEa4FeLaia1ZTM6pVHL4lQzDZvlZjF1bMs/edit#gid=0")
data %>%
filter(Player == "Octane") %>%
ggplot(aes(x = game, y = Score, color = factor(Season), fill = factor(Season)))+
geom_point(alpha = 0.7)+
geom_smooth(se = F)+
geom_hline(aes(yintercept = mean(Score, na.rm = T)))+
theme_minimal()
data %>%
data %>%
select(Week, Goals)
data %>%
select(Week, Season, Goals)
data %>%
select(Season, Week, Goals)
data %>%
select(Season, Week, Goals) %>%
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals))
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals))
x = data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals))
View(x)
x = data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals, na.rm = T)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals, na.rm = T)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
filter(Season != 1) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
filter(Season != 1) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()
data %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()
data %>%
filter(Player = "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()
data %>%
filter(Player = "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()
data %>%
filter(Player == "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()
data %>%
filter(Player == "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()+
geom_smooth()
data %>%
filter(Player == "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()+
geom_smooth()+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_line()+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()+
geom_smooth(method = "lm")+
theme_minimal()
data %>%
filter(Player == "Octane") %>%
filter(Post == 0) %>%
select(Season, Week, Goals) %>%
group_by(Season) %>%
mutate(c_goals = cumsum(Goals)) %>%
ggplot(aes(Week, c_goals, color  = factor(Season), fill = factor(Season)))+
geom_point()+
geom_smooth(method = "lm", se = F)+
theme_minimal()
